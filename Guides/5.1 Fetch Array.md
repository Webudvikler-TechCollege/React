# Fetch array 

Følgende er en guide til at hente data og vise dem. For at gøre dette med hooks, skal vi bruge useEffect og vi skal også bruge useState til at gemme data med.

Eksemplet bruger værktøjet *axios* til at fetche data med. Dette kan installeres med npm:
```
npm install axios
```
Følgende kode beskriver  en komponent, der henter de 17 verdensmål som et array og løber dem igennem med en map metode.

#### 1. Skriv et function component i en ny fil. 
```js
// Fil: FetchArray.jsx
export const FetchArray = () => {
  return (
    <div>FetchArray</div>
  )
}
```
> Du kan bruge emmet forkortelsen *rafc* i VS Code til at generere koden med. Metoden vil navngive din function efter filen.
___
#### 2. Hent dependencies
Den viste kode bruger følgende depency modules som skal importeres i toppen af din fil. Huske at installere axios hvis du ikke allerede har gjort det.
```js
import { useEffect, useState } from "react"
import axios from 'axios'
```
___
#### 3. Indsæt variabel med useState hook 
Vi skal oprette en variabel som kan håndtere værdier fra API'et i vores renderinger. Til at gøre dette skal vi bruge et useState hook:
```js
export const FetchArray = () => {

  // useState Hook sættes til tomt array
  const [apiData, setApiData] = useState([])

  return (
    <div>FetchArray</div>
  )
}
```
___
#### 4. Indsæt useEffect hook
Vi kalder selve funktionaliteten til API kaldet som useEffect hook. På den måde kan vi nemt styre hvornår og hvor tit denne funktion skal eksekveres. Dette gør vi med et dependency array, som er funktionens andet argument:
```js
export const FetchArray = () => {
  
  const [apiData, setApiData] = useState([])

  // useEffect tager to argumenter: 
  // en function og et dependency array
  useEffect(
    () => {}, 
    []
  )

  return (
    <div>FetchArray</div>
  )
}
```
___
#### 4. Indsæt funktion til fetch af data
Vi kan nu lave selve API kaldet inde i den tomme funktion i vores useEffect hook.
Nedenstående eksempel er et udsnit af useEffect metoden og viser deklaration og kald af en *getData* funktion. Funktionen kalder en url med axios.get og skriver svar data til vores tilstandsvariabel.
```js
  // useEffect tager to argumenter: 
  // en function og et dependency array
  useEffect(
    () => {
      // Asyncronous Function declaration
      const getData = async () => {

        const endpoint = `http://somehost/someapi`
        const result = await axios.get(url)
        setApiData(result.path.to.array)
      }

      // Function Call
      getData()
    }, 
    [setData]
  )
```
> Husk at et kald til api altid skal køres fra en asynkron funktion. I ovenstående eksempel er det gjort med async/await.

> API kaldet skal renderes hver gang vi kører setData funktionen fra useState hooket. På den måde sikrer vi at det bliver gjort når siden loades og kun efterfølgende hvis kalder set funktionen igen.
___
#### 4. Indsæt jsx output
Til sidst kan vi udskrive vores output med jsx
```js
export const FetchArray = () => {
  
  ...useState & useEffect kode

  return (
    <>
      {apiData && apiData.map(row => {
        return (
          <p key={row.id}>{row.title}</p>
        )
      })}
    </>
  )
}
```
___
